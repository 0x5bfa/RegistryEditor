<Page
	x:Class="RegistryEditor.WinUI.Views.MainPage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals"
	xmlns:converters="using:RegistryEditor.WinUI.Converters"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:local="using:RegistryEditor.WinUI.Views"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:models="using:RegistryEditor.WinUI.Models"
	xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
	xmlns:uc="using:RegistryEditor.WinUI.UserControls"
	DataContext="{x:Bind ViewModel, Mode=OneWay}"
	mc:Ignorable="d">

	<Page.Resources>
		<ResourceDictionary>

			<converters:ObjectToBoolConverter x:Key="ObjectToBoolConverter" />
			<converters:BoolToGlyphConverter
				x:Key="BoolToGlyphConverter"
				CollapsedGlyph="&#xE76C;"
				ExpandedGlyph="&#xE70D;" />

			<Thickness x:Key="TreeViewItemPresenterPadding">0,0,0,0</Thickness>

		</ResourceDictionary>
	</Page.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="36" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<uc:TitleBarControl />

		<Grid Grid.Row="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto" MinWidth="144" />
				<ColumnDefinition Width="*" MinWidth="144" />
			</Grid.ColumnDefinitions>

			<Grid x:Name="RegistryTreePaneGrid">
				<Grid.RowDefinitions>
					<RowDefinition Height="*" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<ScrollViewer HorizontalScrollBarVisibility="Auto" HorizontalScrollMode="Auto">
					<uc:TreeView
						x:Name="CustomMainTreeView"
						MinWidth="256"
						Margin="0,0,0,24"
						BaseSelectionChanged="CustomMainTreeView_BaseSelectionChanged"
						KeyDeleting="CustomMainTreeView_KeyDeleting"
						KeyExporting="CustomMainTreeView_KeyExporting"
						KeyPropertyWindowOpening="CustomMainTreeView_KeyPropertyWindowOpening"
						KeyRenaming="CustomMainTreeView_KeyRenaming" />
				</ScrollViewer>

				<Border
					Grid.Row="1"
					Height="1"
					Background="{ThemeResource DividerStrokeColorDefaultBrush}" />

				<Button
					x:Name="SettingsButton"
					Grid.Row="2"
					Height="36"
					Margin="4,4,4,6"
					Padding="0"
					HorizontalAlignment="Stretch"
					HorizontalContentAlignment="Stretch"
					Background="Transparent"
					BorderThickness="0"
					Click="SettingsButton_Click">
					<Grid Height="36" ColumnSpacing="6">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="4" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>

						<Border
							x:Name="SettingsButtonClickedBackground"
							Grid.ColumnSpan="2"
							Background="{ThemeResource SubtleFillColorSecondaryBrush}"
							Visibility="Collapsed" />

						<Border
							x:Name="SettingsButtonClickedIndicator"
							Width="3"
							Height="18"
							VerticalAlignment="Center"
							Background="{ThemeResource AccentFillColorDefaultBrush}"
							CornerRadius="1.5"
							Visibility="Collapsed" />

						<StackPanel
							Grid.Column="1"
							VerticalAlignment="Center"
							Orientation="Horizontal"
							Spacing="8">
							<AnimatedIcon x:Name="GameSettingsIcon" Height="16">
								<AnimatedIcon.Source>
									<animatedvisuals:AnimatedSettingsVisualSource />
								</AnimatedIcon.Source>
								<AnimatedIcon.FallbackIconSource>
									<FontIconSource Glyph="&#xE713;" />
								</AnimatedIcon.FallbackIconSource>
							</AnimatedIcon>
							<TextBlock Text="Settings" />
						</StackPanel>
					</Grid>
				</Button>

			</Grid>

			<Grid
				Grid.Column="1"
				Background="{ThemeResource LayerFillColorDefaultBrush}"
				BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
				BorderThickness="1,1,0,0"
				CornerRadius="8,0,0,0">
				<toolkit:PropertySizer
					HorizontalAlignment="Left"
					Binding="{x:Bind RegistryTreePaneGrid.Width, Mode=TwoWay}"
					Maximum="440"
					Minimum="144" />

				<Frame x:Name="ContentFrame" Margin="6,0,0,0" />
			</Grid>

		</Grid>

	</Grid>
</Page>
